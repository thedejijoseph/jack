<!DOCTYPE html>
<html lang="en">
	
	<head>
		<title>Word Jack!</title>
		<meta name="viewport" content="width=device-width, scale=1"/>
		
		<style>
			@import url("{{ static_url('css/materialize.min.css') }}");
			
			body{
				font-family: serif;
			}
			#header{
				margin: 10px 0px;;
				font-size: 2em;
			}
			
			#feedback{
				margin: 12px 0px;
				font-size: 0.9rem;
				text-transform: uppercase;
			}
		</style>
	</head>
	
	<body>
		<div id="container" class="container row">
			<div id="header" class="col s12 m12 l12">
				<div>Word Jack!</div>
			</div>
			
			<div id="waiter" class="col s12 l4">
				<form id="orderForm">
					<div id="call">
						<input type="text" name="order" id="orderBox" autocomplete="off"/>
					</div>
					<div id="controls" class="">
						<input type="submit" value="order" id="makeOrder" class="btn white black-text"/>
						<button id="clearOrder" class="btn white black-text">clear</button>
					</div>
				</form>
				<div id="feedback">
					hi, what would like to have today?
				</div>
			</div>
			
			<div id="menu" class="col s12 l8 center grey lighten-3">
				
			</div>
		</div>
		
		<script>
document.getElementById("makeOrder").addEventListener("click", makeOrder);

document.getElementById("clearOrder").addEventListener("click", clearOrder);

function makeOrder(e){
	e.preventDefault();
	
	var xhr = new XMLHttpRequest();
	
	var feedback = document.getElementById("feedback");
	var order = document.getElementById("orderBox").value;
	
	if (order.length >= 10){
		feedback.innerHTML = "Sorry. We don't take orders this large.";
		return
	}
	
	xhr.open('GET', '/serve?order=' + order, true);
	
	xhr.onreadystatechange = function(){
		if (this.readyState == 4){
			feedback.innerHTML = "here's your order";
			serveOrder(this.responseText);
		}
	}
	
	xhr.send();
	feedback.innerHTML = "processing";
}

function serveOrder(delivery){
	delivery = JSON.parse(delivery);
	var size = delivery.length;
	var serving_size;
	
	if (size == 1){
		serving_size = "serving";
	}else{serving_size = "servings";}
	
	feedback.innerHTML += " (" + size + " " + serving_size + " long)"
	serving = "<ul>";
	
	delivery.forEach(function(item) {
		serving += "<li>" + item.toUpperCase() + "</li>";
	});
	
	serving += "</ul>";
	document.getElementById("menu").innerHTML = serving;
}
function clearOrder(e){
	e.preventDefault();
	document.getElementById("orderBox").value = "";
	document.getElementById("menu").innerHTML = "";
	feedback.innerHTML = "";
}
		</script>
	</body>

</html>